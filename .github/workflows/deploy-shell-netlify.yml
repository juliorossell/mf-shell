- name: ğŸ“¦ Setup Node.js v22.12.0
  uses: actions/setup-node@v5
  with:
    node-version: '22.12.0'
    cache: 'npm'

- name: ğŸ” Verify toolchain
  shell: bash
  run: |
    which node
    node -v
    which npm
    npm -v
    node -p "process.execPath"
    [[ "$(node -v)" == "v22.12.0" ]] || (echo "âŒ Wrong Node" && exit 1)

- name: ğŸ” Configure npm auth
  shell: bash
  run: echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc
  env:
  NPM_TOKEN: ${{ secrets.NPM_TOKEN }}

- name: ğŸ“š Install Dependencies
  shell: bash
  run: npm ci --legacy-peer-deps

- name: ğŸ—ï¸ Build for Production
  shell: bash
  run: npm run build:multirepo
